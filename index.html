<!DOCTYPE html>
<html>
    <head>
        <title>Portfolio</title>
        <link rel="stylesheet" type="text/css" href="./styles/style.css" />
        <link rel="stylesheet" type="text/css" href="./fonts/fontawesome-free-5.14.0-web/css/all.css" />
    </head>
    <body>
        <header id="pageHeader">
            <div id="navBar">
                <div id="navBarBg">
                    <!-- <div class="defaultBg"></div>
                    <div class="border"></div> -->
                </div>
                <div id=navBarContent>
                    <h3>Portfolio</h3>
                    <nav>
                        <a><i class="fab fa-github fa-2x"></i></a>
                        <a><i class="fab fa-linkedin fa-2x"></i></a>
                    </nav>
                </div>
            </div>
            <div id="headerBg">
                <div class="bgLayer bgLayer1"></div>
                <div class="bgLayer bgLayer2"></div>
            </div>
            <div id="headerContent">
                <h1>Projects</h1>
            </div>
            <a href="#pageFooter"><i id="headerArrowDown" class="fas fa-arrow-down fa-2x"></i></a>
        </header>
        <section id="projectSection">
            <div id="projectTable" class="sectionContent">
                <div id="item-1" class="tableItem">
                    <div class="titleBar">
                        <h1>Project 1</h1>
                        <i class="fas fa-caret-down fa-2x" onclick="handleClick(this, 'item-1', 'itemContent-1', 0)"></i>
                    </div>
                    <div id="itemContent-1" class="itemContent">
                        <div class="itemImage"></div>
                        <p>
                            Lorem ipsum dolor sit amet consectetur adipisicing elit. 
                            Excepturi voluptatibus illo odio non expedita nisi consequatur quod incidunt odit? 
                            Tempora et cum ullam esse ut dolores consequatur eum natus velit saepe. 
                            Possimus eum veritatis officia temporibus commodi dicta ullam facere aliquam similique quia, 
                            dolor modi ratione blanditiis quibusdam rem eius?
                        </p>
                        <span class="buttons">
                            <button>App</button>
                            <button>Code</button>
                        </span>
                    </div>
                </div>
                <!-- <div class="tableItem">
                    <h2 class="itemTitle">Project 1</h2>
                    <img class="itemImage" src="./images/butterfly-2049567_1920.jpg"></img>
                    <p class="itemText">Lorem ipsum dolor sit amet consectetur adipisicing elit. 
                        Eos porro eveniet nostrum possimus nobis placeat vitae animi quisquam vero harum eum quidem nihil, 
                        odit ut quo doloremque amet. Accusantium, deserunt! Ipsam, est. Accusantium provident, non, 
                        impedit ut recusandae eos in sit aliquam tempora ratione veritatis vitae asperiores deleniti 
                        fugiat repellat.</p>
                        <span class="buttons">
                            <button>App</button>
                            <button>Code</button>
                        </span>
                </div>
                <div class="tableItem">
                    <h2 class="itemTitle">Project 2</h2>
                    <img class="itemImage" src="./images/butterfly-2049567_1920.jpg"></img>
                    <p class="itemText">Lorem ipsum dolor sit amet consectetur adipisicing elit. 
                        Eos porro eveniet nostrum possimus nobis placeat vitae animi quisquam vero harum eum quidem nihil, 
                        odit ut quo doloremque amet. Accusantium, deserunt! Ipsam, est. Accusantium provident, non, 
                        impedit ut recusandae eos in sit aliquam tempora ratione veritatis vitae asperiores deleniti 
                        fugiat repellat.</p>
                        <span class="buttons">
                            <button>App</button>
                            <button>Code</button>
                        </span>
                </div>
                <div class="tableItem">
                    <h2 class="itemTitle">Project 3</h2>
                    <img class="itemImage" src="./images/butterfly-2049567_1920.jpg"></img>
                    <p class="itemText">Lorem ipsum dolor sit amet consectetur adipisicing elit. 
                        Eos porro eveniet nostrum possimus nobis placeat vitae animi quisquam vero harum eum quidem nihil, 
                        odit ut quo doloremque amet. Accusantium, deserunt! Ipsam, est. Accusantium provident, non, 
                        impedit ut recusandae eos in sit aliquam tempora ratione veritatis vitae asperiores deleniti 
                        fugiat repellat.</p>
                        <span class="buttons">
                            <button>App</button>
                            <button>Code</button>
                        </span>
                </div> -->
            </div>
        </section>
        <footer id="pageFooter">
            <a href="#pageHeader"><i id="footerArrowUp" class="fas fa-arrow-up fa-2x"></i></a>
            <div id="footerBg">
                <div class="bgLayer bgLayer1"></div>
                <div class="bgLayer bgLayer2"></div>
            </div>
            <div id="footerContent">
                <h1>The End</h1>
            </div>
            <div id="footerBar">
                <div id="footerBarBg"></div>
                <div id="footerBarContent">
                    <div>Sami Aartolahti</div>
                    <div>September 4th 2020</div>
                </div>
            </div>
        </footer>
    </body>
    <script>
        const navBarBg = document.getElementById("navBarBg");
        const pageFooter = document.getElementById("pageFooter");
        const pageFooterOffset = pageFooter.offsetTop - innerHeight * 0.15;
        const footerBarBg = document.getElementById("footerBarBg");
        let navBarHasAngle = false;
        let footerHasAngle = false;
        let width = innerWidth;
        let height = innerHeight;

        // Find out the right angle for the navBarBg and footerBarBg
        let rad = (Math.atan((height * 0.78) / width));
        let deg = rad * (180 / Math.PI);

        // Initialize the navBarBg
        navBarBg.style.transform = "skewY(" + 0 + "deg) translateY(-90%)";
        navBarHasAngle = true;
        skewNavBarAnimation();

        // Start or stop playing animations depending on what on how much the page has been scrolled
        onscroll = function() {
            if (document.documentElement.scrollTop <= 0 && navBarHasAngle === false) {
                navBarHasAngle = true;
                skewNavBarAnimation();
            } else if (document.documentElement.scrollTop > height && navBarHasAngle === true) {
                navBarHasAngle = false;
                navBarBg.style.transform = "skewY(" + 0 + "deg) translateY(-90%)";
            } else if (document.documentElement.scrollTop >= pageFooterOffset && footerHasAngle === false) {
                footerHasAngle = true;
                skewFooterBarAnimation();
            } else if (document.documentElement.scrollTop < pageFooterOffset - height && footerHasAngle === true) {
                footerHasAngle = false;
                footerBarBg.style.transform = "skewY(" + 0 + "deg)";
            }
        };

        // Function which starts and stops the skew animation of navBarBg element
        function skewNavBarAnimation() {
            let newDeg = 0;
            let change = rad;

            const skewNavBarInterval = setInterval(() => {
                if (newDeg >= deg) {
                    clearInterval(skewNavBarInterval);
                } else if (navBarHasAngle === false) {
                    navBarBg.style.transform = "skewY(" + 0 + "deg) translateY(-90%)";
                    clearInterval(skewNavBarInterval);
                } else {
                    change = change * 0.983;
                    newDeg = newDeg + change;
                    navBarBg.style.transform = "skewY(" + (-newDeg) + "deg) translateY(-90%)";
                }
            }, 15);
        }

        // Function which starts and stops the skew animation of footerBarBg element
        function skewFooterBarAnimation() {
            let newDeg = 0;
            let change = rad;

            const skewFooterBarInterval = setInterval(() => {
                if (newDeg >= deg) {
                    clearInterval(skewFooterBarInterval);
                } else if (footerHasAngle === false) {
                    footerBarBg.style.transform = "skewY(" + 0 + "deg)";
                    clearInterval(skewFooterBarInterval);
                } else {
                    change = change * 0.983;
                    newDeg = newDeg + change;
                    footerBarBg.style.transform = "skewY(" + (-newDeg) + "deg)";
                }
            }, 15);
        }
        
        // Get tableItems heights for later use in handleClick function
        const tableItemsList = document.getElementsByClassName("tableItem");
        let itemHeightsList = [];
        for (let i = 0; i < tableItemsList.length; i++) {
            itemHeightsList[i] = Number.parseFloat(getComputedStyle(tableItemsList[i]).height);
            tableItemsList[i].style.height = "10vh";
        }

        // Function for showing or hiding the project content
        function handleClick(buttonContext, itemId, itemContentId, index) {
            const item = document.getElementById(itemId);
            // const itemContent = document.getElementById(itemContentId);
            // let itemHeight = 10;
            let finalHeight = Number.parseInt((itemHeightsList[index] / innerHeight) * 100);
            // let change = 2;

            if (buttonContext.style.transform !==  "rotate(180deg)") {
                buttonContext.style.transform = "rotate(180deg)";
            } else {
                buttonContext.style.transform = "";
                // itemHeight = finalHeight;
                finalHeight = 10;
                // change = -change;
            }

            item.style.height = finalHeight + "vh";

            // const animateItemContent = setInterval(() => {
            //     change = change * 0.95;
            //     itemHeight = itemHeight + change;
            //     item.style.height = itemHeight + "vh";

            //     if ((finalHeight > 10 && itemHeight >= finalHeight * 0.95) || (finalHeight === 10 && itemHeight <= finalHeight * 1.05)) {
            //         clearInterval(animateItemContent);
            //     }
            // }, 15);
        }
    </script>
</html>